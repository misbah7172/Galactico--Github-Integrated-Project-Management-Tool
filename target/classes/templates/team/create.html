<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Create Team - AutoTrack</title>
    <link rel="stylesheet" href="css/main.css" />
  </head>
  <body>
    <!-- Header -->
    <div class="header">
      <h2>AutoTrack</h2>
    </div>

    <div class="container">
      <!-- Alert Messages (placeholders) -->
      <div class="alert alert-success" style="display: none">
        Success message here
      </div>
      <div class="alert alert-danger" style="display: none">
        Error message here
      </div>

      <!-- Page Header -->
      <div class="page-header">
        <div class="page-header-content">
          <div>
            <h1 class="page-title">üë• Create New Team</h1>
            <p class="page-description">
              Build your team and start collaborating on projects
            </p>
          </div>
        </div>
      </div>

      <!-- Create Team Form -->
      <div class="form-container">
        <div class="form-card">
          <div class="form-header">
            <h2 class="form-title">Team Details</h2>
            <p class="form-subtitle">Set up your team and invite members</p>
          </div>

          <form id="createTeamForm" class="form">
            <!-- Team Name -->
            <div class="form-group">
              <label for="name" class="form-label">Team Name *</label>
              <input
                type="text"
                id="name"
                class="form-control"
                placeholder="Enter a descriptive team name"
                required
              />
              <div class="form-error" style="display: none">Error for name</div>
            </div>

            <!-- Team Description -->
            <div class="form-group">
              <label for="description" class="form-label">Description</label>
              <textarea
                id="description"
                class="form-control"
                rows="3"
                placeholder="Brief description of your team's purpose and goals"
              ></textarea>
              <div class="form-error" style="display: none">
                Error for description
              </div>
            </div>

            <!-- GitHub Organization URL -->
            <div class="form-group">
              <label for="githubOrganizationUrl" class="form-label"
                >GitHub Organization URL</label
              >
              <input
                type="url"
                id="githubOrganizationUrl"
                class="form-control"
                placeholder="https://github.com/your-organization"
              />
              <p class="form-help">
                Optional: Link to your GitHub organization or main repository
              </p>
              <div class="form-error" style="display: none">Error for URL</div>
            </div>

            <!-- Team Members Info -->
            <div class="form-group">
              <label class="form-label">Team Members</label>
              <p class="form-help">
                After creating the team, you can invite members using their
                GitHub profiles.
              </p>
              <div class="info-box">
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <circle cx="12" cy="12" r="10" />
                  <path d="M12 16v-4m0-4h.01" />
                </svg>
                <span
                  >You will be automatically added as the team owner. Invite
                  other members after creation.</span
                >
              </div>
            </div>

            <!-- Form Actions -->
            <div class="form-actions">
              <button type="submit" class="btn btn-primary">
                <svg
                  class="btn-icon"
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M12 5v14m-7-7h14" />
                </svg>
                Create Team
              </button>
              <a href="#" class="btn btn-secondary">Cancel</a>
            </div>
          </form>

          <!-- Team Invitation Section -->
          <div
            id="inviteSection"
            class="form-card"
            style="display: none; margin-top: 2rem"
          >
            <div class="form-header">
              <h3 class="form-title">üéØ Invite Team Members</h3>
              <p class="form-subtitle">
                Send invitations to developers via their GitHub profiles
              </p>
            </div>

            <div class="invite-form">
              <!-- Single Invitation -->
              <div class="form-group">
                <label for="inviteGithubUrl" class="form-label"
                  >GitHub Profile URL</label
                >
                <div class="invite-input-group">
                  <input
                    type="text"
                    id="inviteGithubUrl"
                    class="form-control"
                    placeholder="https://github.com/username or just username"
                  />
                  <button
                    type="button"
                    id="addInviteBtn"
                    class="btn btn-secondary"
                  >
                    <svg
                      class="btn-icon"
                      width="16"
                      height="16"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <line x1="12" y1="5" x2="12" y2="19"></line>
                      <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    Add
                  </button>
                </div>
                <small class="form-help"
                  >Enter GitHub profile URL or just the username</small
                >
              </div>

              <!-- Batch Invitation -->
              <div class="form-group">
                <label for="batchInvites" class="form-label"
                  >üìù Bulk Invite (Multiple Members)</label
                >
                <textarea
                  id="batchInvites"
                  class="form-control"
                  rows="4"
                  placeholder="username1&#10;https://github.com/username2&#10;username3"
                ></textarea>
                <button
                  type="button"
                  id="addBatchInvitesBtn"
                  class="btn btn-secondary"
                >
                  <svg
                    class="btn-icon"
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <rect
                      x="9"
                      y="9"
                      width="13"
                      height="13"
                      rx="2"
                      ry="2"
                    ></rect>
                    <path d="m5 15-4-4 4-4"></path>
                    <path d="m11 19 4-4-4-4"></path>
                  </svg>
                  Add All
                </button>
              </div>

              <!-- Pending Invitations List -->
              <div
                id="pendingInvitesList"
                class="pending-invites-list"
                style="display: none"
              >
                <h5>üìã Members to Invite</h5>
                <div
                  id="pendingInvitesContainer"
                  class="pending-invites-container"
                ></div>
              </div>

              <div class="form-group">
                <label for="inviteMessage" class="form-label"
                  >Invitation Message</label
                >
                <textarea
                  id="inviteMessage"
                  class="form-control"
                  rows="3"
                  placeholder="Join our team to collaborate on exciting projects!"
                ></textarea>
              </div>

              <button
                type="button"
                id="sendAllInvitesBtn"
                class="btn btn-primary"
                disabled
              >
                <svg
                  class="btn-icon"
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    d="M3 8l7.89 3.26a2 2 0 001.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 002 2v10a2 2 0 002 2z"
                  />
                </svg>
                Send All Invitations
              </button>

              <button
                type="button"
                id="sendInviteBtn"
                class="btn btn-outline-primary"
                style="margin-left: 1rem"
              >
                <svg
                  class="btn-icon"
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    d="M3 8l7.89 3.26a2 2 0 001.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
                  />
                </svg>
                Send Single Invitation
              </button>
            </div>

            <!-- Sent Invitations List -->
            <div id="sentInvitations" class="sent-invitations">
              <h4>üì§ Sent Invitations</h4>
              <div id="invitationsList" class="invitations-list">
                <p class="no-invitations">No invitations sent yet</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      let pendingInvites = [];
      let teamCreated = false;

      // Handle Create Team
      document
        .getElementById("createTeamForm")
        .addEventListener("submit", function (e) {
          e.preventDefault();
          teamCreated = true;
          alert("Team created successfully!");
          document.getElementById("inviteSection").style.display = "block";
        });

      // Add single invite
      document
        .getElementById("addInviteBtn")
        .addEventListener("click", function () {
          const githubUrl = document
            .getElementById("inviteGithubUrl")
            .value.trim();
          if (githubUrl) {
            addToPendingInvites(githubUrl);
            document.getElementById("inviteGithubUrl").value = "";
          }
        });

      // Add batch invites
      document
        .getElementById("addBatchInvitesBtn")
        .addEventListener("click", function () {
          const batchText = document
            .getElementById("batchInvites")
            .value.trim();
          if (batchText) {
            const lines = batchText
              .split("\n")
              .map((line) => line.trim())
              .filter((line) => line);
            lines.forEach((line) => addToPendingInvites(line));
            document.getElementById("batchInvites").value = "";
          }
        });

      // Add to pending invites list
      function addToPendingInvites(githubUrl) {
        if (!pendingInvites.includes(githubUrl)) {
          pendingInvites.push(githubUrl);
          updatePendingInvitesList();
        }
      }

      // Update pending invites display
      function updatePendingInvitesList() {
        const container = document.getElementById("pendingInvitesContainer");
        const listElement = document.getElementById("pendingInvitesList");
        const sendButton = document.getElementById("sendAllInvitesBtn");

        if (pendingInvites.length === 0) {
          listElement.style.display = "none";
          sendButton.disabled = true;
          return;
        }

        listElement.style.display = "block";
        sendButton.disabled = false;

        container.innerHTML = pendingInvites
          .map(
            (url, index) => `
                <div class="pending-invite-item">
                    <span class="invite-url">${url.replace(
                      "https://github.com/",
                      "@"
                    )}</span>
                    <button type="button" class="btn-remove" onclick="removePendingInvite(${index})">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </div>
            `
          )
          .join("");
      }

      // Remove pending invite
      function removePendingInvite(index) {
        pendingInvites.splice(index, 1);
        updatePendingInvitesList();
      }

      // Simulate sending all invites
      document
        .getElementById("sendAllInvitesBtn")
        .addEventListener("click", function () {
          if (!teamCreated) {
            alert("Please create a team first");
            return;
          }
          if (pendingInvites.length === 0) {
            alert("No invitations to send");
            return;
          }
          alert(`Sent ${pendingInvites.length} invitation(s) successfully!`);
          pendingInvites = [];
          updatePendingInvitesList();
          document.getElementById("inviteMessage").value = "";

          document.getElementById("invitationsList").innerHTML =
            '<p class="no-invitations">Invitations have been sent!</p>';
        });

      // Simulate sending single invite
      document
        .getElementById("sendInviteBtn")
        .addEventListener("click", function () {
          if (!teamCreated) {
            alert("Please create a team first");
            return;
          }
          const githubUrl = document
            .getElementById("inviteGithubUrl")
            .value.trim();
          if (!githubUrl) {
            alert("Please enter a GitHub profile URL");
            return;
          }
          alert(`Invitation sent to ${githubUrl}!`);
          document.getElementById("inviteGithubUrl").value = "";
          document.getElementById("inviteMessage").value = "";

          document.getElementById("invitationsList").innerHTML =
            '<p class="no-invitations">One invitation sent!</p>';
        });
    </script>
    <style>
      .info-box {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 1rem;
        background: var(--info-bg);
        border: 1px solid var(--info-border);
        border-radius: 6px;
        color: var(--info-text);
        font-size: 0.875rem;
      }

      .invite-form {
        padding: 1.5rem;
        border: 1px solid var(--border-color);
        border-radius: 8px;
        margin-bottom: 2rem;
        background: var(--surface-color);
      }

      .invite-input-group {
        display: flex;
        gap: 0.5rem;
        align-items: center;
      }

      .invite-input-group input {
        flex: 1;
      }

      .batch-invite-section {
        margin-top: 1.5rem;
        padding-top: 1.5rem;
        border-top: 1px solid var(--border-color);
      }

      .pending-invites-list {
        margin-top: 1rem;
        padding: 1rem;
        background: #f8f9fa;
        border-radius: 6px;
        border: 1px solid var(--border-color);
      }

      .pending-invites-list h5 {
        margin: 0 0 1rem 0;
        color: var(--text-primary);
      }

      .pending-invites-container {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
      }

      .pending-invite-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0.5rem 0.75rem;
        background: white;
        border: 1px solid var(--border-color);
        border-radius: 4px;
      }

      .invite-url {
        font-family: monospace;
        color: var(--primary-color);
        font-size: 0.875rem;
      }

      .btn-remove {
        background: none;
        border: none;
        color: var(--danger-color);
        cursor: pointer;
        padding: 0.25rem;
        border-radius: 3px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .btn-remove:hover {
        background: var(--danger-bg);
      }

      .sent-invitations h4 {
        margin-bottom: 1rem;
        color: var(--text-primary);
      }

      .invitations-list {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
      }

      .invitation-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem;
        border: 1px solid var(--border-color);
        border-radius: 6px;
        background: var(--background-color);
      }

      .invitation-info {
        flex: 1;
      }

      .invitation-user {
        font-weight: 500;
        margin-bottom: 0.25rem;
      }

      .invitation-user a {
        color: var(--primary-color);
        text-decoration: none;
        font-family: monospace;
      }

      .invitation-user a:hover {
        text-decoration: underline;
      }

      .invitation-message {
        font-size: 0.875rem;
        color: var(--text-secondary);
        margin-bottom: 0.25rem;
        font-style: italic;
      }

      .invitation-date {
        font-size: 0.75rem;
        color: var(--text-muted);
      }

      .status-badge {
        padding: 0.25rem 0.75rem;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 500;
        text-transform: uppercase;
      }

      .status-pending {
        background: #fef3c7;
        color: #92400e;
      }

      .status-accepted {
        background: #d1fae5;
        color: #065f46;
      }

      .status-rejected {
        background: #fee2e2;
        color: #991b1b;
      }

      .no-invitations {
        text-align: center;
        color: var(--text-muted);
        font-style: italic;
        padding: 2rem;
      }
    </style>

    <!-- Footer Fragment -->
    <div th:replace="~{fragments/footer :: footer}"></div>
  </body>
</html>
